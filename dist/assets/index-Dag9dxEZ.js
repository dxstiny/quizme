import{b as j,E as D,_ as I}from"./index.vue_vue_type_script_setup_true_lang-C246FbVC.js";import{d as U,r as b,e as H,o as J,s as G,f as B,a as y,c as _,b as t,F as M,t as w,m as d,I as h,k as V,v as Q,x as X,_ as O,D as A,y as z,g as N,i as L,n as R,h as W,j as n,l as F,T as Y}from"./index-BsjsBPlp.js";import{_ as K}from"./WithSidebar.vue_vue_type_style_index_0_lang-D4HIvgR_.js";import"./FillInTheBlank.vue_vue_type_style_index_0_lang-D0amPu6h.js";import"./ExpandedDropdown-BdD3VhF6.js";/* empty css                                                                         */import"./_commonjsHelpers-C4iS2aBk.js";const Z={class:"options"},q={key:0,class:"option"},ee={class:"option"},te={class:"option"},se={key:0},oe=["value"],le={key:1},ne={class:"options"},ae=U({__name:"ShareModal",setup(v,{expose:c}){const s=b(!1),e=b(""),r=b(!1),p=b(!1),m=b(),a=b(null),T=H(),$=b(""),x=b();J(()=>{const g=G.pat();s.value=!!g});const u=g=>{var l,k;a.value=null,(l=x.value)==null||l.showModal(),g.id!==((k=m.value)==null?void 0:k.id)&&(r.value=!1,p.value=!1,e.value=""),m.value=g},o=()=>{G.setPat($.value),s.value=!0},f=async()=>{const g=m.value;if(!g)return;const l=JSON.parse(JSON.stringify(g));delete l.remote,r.value||(l.score={}),e.value=await T.shareCourse(l,p.value)??""},i=()=>{var g;T.downloadCourse(m.value),(g=x.value)==null||g.close()},C=()=>{var k;const g=m.value;if(!g)return;const l=JSON.parse(JSON.stringify(g));r.value||(l.score={}),T.shareCourse(l,p.value),(k=x.value)==null||k.close()},S=B(()=>{var l,k;if(!((k=(l=m.value)==null?void 0:l.remote)!=null&&k.length))return!1;const g=m.value.remote[0].identifier;return G.isMine(g)});return c({open:u}),(g,l)=>(y(),_("dialog",{ref_key:"dialog",ref:x},[t("span",{class:"material-symbols-rounded close",onClick:l[0]||(l[0]=k=>{var P;return(P=x.value)==null?void 0:P.close()})}," close "),!a.value&&m.value?(y(),_(M,{key:0},[t("h1",null,'Share "'+w(m.value.title)+'"',1),t("div",Z,[S.value?(y(),_("div",q,[l[5]||(l[5]=t("div",{class:"info"},[t("h3",null,"Update remote"),t("p",null," This course is already shared. Update the remote to share the latest changes. ")],-1)),d(h,{type:"action-green",icon:"update",label:"Update",onClick:C})])):V("",!0),t("div",ee,[l[6]||(l[6]=t("div",{class:"info"},[t("h3",null,"New share"),t("p",null," Share this course for the first time. This will create a new gist on GitHub. ")],-1)),d(h,{type:"action-green",icon:"share",label:"Share",onClick:l[1]||(l[1]=k=>a.value="gist")})]),t("div",te,[l[7]||(l[7]=t("div",{class:"info"},[t("h3",null,"Download"),t("p",null," Download the course as a JSON file. This can be used to import the course on another device. ")],-1)),d(h,{type:"action-green",icon:"download",label:"Download",onClick:i})])])],64)):!s.value&&a.value?(y(),_(M,{key:1},[l[8]||(l[8]=t("h1",null,"GitHub Gists PAT",-1)),l[9]||(l[9]=t("p",null," To use this feature, you need to provide a GitHub Gists PAT. This is used to create gists for sharing courses. ",-1)),Q(t("input",{type:"text","onUpdate:modelValue":l[2]||(l[2]=k=>$.value=k),placeholder:"Enter your PAT here"},null,512),[[X,$.value]]),d(h,{type:"action-green",icon:"done",label:"Save",disabled:!$.value.length,onClick:o},null,8,["disabled"])],64)):a.value=="gist"&&m.value?(y(),_(M,{key:2},[t("h1",null,'Share "'+w(m.value.title)+'"',1),e.value?(y(),_("div",se,[l[10]||(l[10]=t("p",null,"Your share link:",-1)),t("input",{type:"text",readonly:"",value:e.value},null,8,oe)])):(y(),_("div",le,[l[11]||(l[11]=t("p",null," To share this course, click the button below. This will create a gist on GitHub with the course data. ",-1)),t("div",ne,[d(j,{label:"Include Progress",modelValue:r.value,"onUpdate:modelValue":l[3]||(l[3]=k=>r.value=k)},null,8,["modelValue"]),d(j,{label:"Public Gist",modelValue:p.value,"onUpdate:modelValue":l[4]||(l[4]=k=>p.value=k)},null,8,["modelValue"])]),d(h,{type:"action-green",icon:"share",label:"Share",onClick:f})]))],64)):V("",!0)],512))}}),ie=O(ae,[["__scopeId","data-v-856da437"]]),re=v=>{let c=`# ${v.title}
`;return c+=E(v,{insertHeading:s=>`## ${s}
`,insertDescription:s=>`${s}
`,insertList:s=>s.map(e=>`- ${e}`).join(`
`)+`
`,insertOrderedList:s=>s.map((e,r)=>`${r+1}. ${e}`).join(`
`)+`
`,insertMap:s=>s.map(([e,r])=>`- ${e} -> ${r}`).join(`
`)+`
`,insertText:s=>`${s}
`}),c},ue=v=>{let c=`\\documentclass{article}

\\usepackage{csquotes}
\\usepackage[T1]{fontenc}

\\raggedright

\\title{${v.title}}
\\author{Generated by QuizMe}
\\date{\\today}

\\begin{document}

\\maketitle
`;const s=e=>(e=e.replace(/\\/g,"\\textbackslash{}").replace(/\{/g,"\\{").replace(/\}/g,"\\}").replace(/&/g,"\\&").replace(/%/g,"\\%").replace(/\$/g,"\\$").replace(/#/g,"\\#").replace(/"([^"]*)"/g,"\\enquote{$1}"),de(e));return c+=E(v,{insertHeading:e=>`\\section{${s(e)}}
`,insertDescription:e=>`${s(e)}
`,insertList:e=>`\\begin{itemize}
${e.map(r=>`\\item ${s(r)}`).join(`
`)}
\\end{itemize}
`,insertOrderedList:e=>`\\begin{enumerate}
${e.map(r=>`\\item ${s(r)}`).join(`
`)}
\\end{enumerate}
`,insertMap:e=>`\\begin{itemize}
${e.map(([r,p])=>`\\item ${s(r)} \\textrightarrow ${s(p)}`).join(`
`)}
\\end{itemize}
`,insertText:e=>`${s(e)}
`}),c+=`
\\end{document}
`,c},E=(v,c)=>{let s="";for(const e of v.questions)if(!(e.type==="true-false"&&!e.solution))switch(s+=c.insertHeading(e.title),s+=c.insertDescription(e.question),e.type){case"multiple-answer":s+=c.insertList(e.solution.map(r=>e.options[r]));break;case"multiple-choice":s+=c.insertText(e.options[e.solution]);break;case"ordering":s+=c.insertOrderedList(e.solution);break;case"true-false":break;case"fill-in-the-blank":s+=e.solution;break;case"matching":s+=c.insertMap(e.solution);break;default:s+=c.insertText(String(e.solution));break}return s},de=v=>{const c=v.split(`
`);let s=0;const e=[];for(const r of c){let p=r.trim();if((p.startsWith("\\item -")||p.startsWith("\\item *"))&&(s===0&&(e.push("\\begin{itemize}"),s++),p=p.replace(/\\item [-*]/,"-").trim()),p.startsWith("-")||p.startsWith("*")){s===0&&(e.push("\\begin{itemize}"),s++);const m=p.replace(/^-/,"").trim();e.push(`  \\item ${m}`)}else{for(let m=0;m<s;m++)e.push("\\end{itemize}");s=0,e.push(r)}}for(let r=0;r<s;r++)e.push("\\end{itemize}");return e.join(`
`)},ce={class:"export-options"},pe=["href","download"],me={class:"output"},ve=U({__name:"SummaryGenerator",props:{course:{type:Object,required:!1}},setup(v,{expose:c}){const s=b("LaTeX"),e=b(null),r=b(!1),p=b(!1),m=b(),a=v,T=()=>{var o;e.value=null,r.value=!1,p.value=!1,(o=m.value)==null||o.showModal()},$=()=>{if(a.course)switch(s.value){case"LaTeX":e.value=ue(a.course);break;case"Markdown":e.value=re(a.course);break}},x=o=>o==="LaTeX"?"tex":"md",u=()=>{e.value&&(navigator.clipboard.writeText(e.value),r.value=!0)};return c({open:T}),(o,f)=>(y(),_("dialog",{ref_key:"dialog",ref:m},[t("span",{class:"material-symbols-rounded close",onClick:f[0]||(f[0]=i=>{var C;return(C=m.value)==null?void 0:C.close()})}," close "),v.course&&!e.value?(y(),_(M,{key:0},[t("h1",null,'Create a Summary for "'+w(v.course.title)+'"',1),f[3]||(f[3]=t("p",null,"Choose the format for the summary you want to generate.",-1)),d(A,{modelValue:s.value,"onUpdate:modelValue":f[1]||(f[1]=i=>s.value=i),options:[{label:"LaTeX",value:"LaTeX"},{label:"Markdown",value:"Markdown"}]},null,8,["modelValue"]),d(h,{icon:"play_arrow",label:"Generate",onClick:$,type:"action-green"})],64)):v.course&&e.value?(y(),_(M,{key:1},[t("h1",null,'Summary for "'+w(v.course.title)+'"',1),t("div",ce,[t("a",{href:"data:text/plain;charset=utf-8,"+encodeURIComponent(e.value),download:"summary."+x(s.value),onClick:f[2]||(f[2]=i=>p.value=!0)},[t("span",{class:z(["material-symbols-rounded option",{clicked:p.value}])},w(p.value?"download_done":"file_download"),3)],8,pe),t("span",{class:z(["material-symbols-rounded option",{clicked:r.value}]),onClick:u},w(r.value?"assignment_turned_in":"content_copy"),3)]),t("div",me,[t("p",null,w(e.value),1)])],64)):V("",!0)],512))}}),fe=O(ve,[["__scopeId","data-v-f6182516"]]),he={class:"wrap"},ye={class:"editor"},ge={key:0,class:"meta"},ke={class:"muted"},be={class:"card"},_e={class:"progress"},$e={class:"bar"},we=["value"],Ce={class:"muted"},xe={class:"actions"},Se={class:"actions"},Te={key:1,class:"questions"},Ve={class:"question-wrapper"},Me={class:"header"},Ge={class:"left"},Le={class:"muted"},Ue={class:"middle"},Oe={class:"right"},Pe=["onClick"],je={key:0,class:"content"},De={class:"actions"},ze=U({__name:"index",setup(v){const c=R(),s=W(),e=H(),r=b(),p=b(),m=c.params.id,a=e.courses.find(u=>u.id===m);a||s.push("/");const T=(u,o)=>{const f=u.type;if(f===o)return!1;let i=!1;return typeof u.solution=="array"?i=u.solution.length>0:typeof u.solution=="object"?i=Object.keys(u.solution).length>0:i=!!u.solution,i&&!confirm("Are you sure you want to change the question type?")?!1:(o==="multiple-choice"?f==="multiple-answer"?u.solution=u.solution[0]:(u.options=[],u.solution=-1):o==="multiple-answer"?f==="multiple-choice"?u.solution=[u.solution]:(u.options=[],u.solution=[]):o==="ordering"?u.solution=[]:o==="fill-in-the-blank"?(u.text="Hello, -[world]-!",u.solution=["world"]):o==="matching"?u.solution=[]:u.solution="",u.type=o,!0)},$=b([]),x=u=>{$.value.includes(u)?$.value=$.value.filter(o=>o!==u):$.value.push(u)};return(u,o)=>(y(),N(K,null,{default:L(()=>{var f;return[d(ie,{ref_key:"shareModal",ref:r},null,512),d(fe,{ref_key:"summaryGenerator",ref:p,course:n(a)},null,8,["course"]),t("div",he,[t("div",ye,[n(a)?(y(),_("div",ge,[d(D,{modelValue:n(a).title,"onUpdate:modelValue":o[0]||(o[0]=i=>n(a).title=i),placeholder:"Click to edit title",class:"h1"},{default:L(()=>[t("h1",null,w(n(a).title),1)]),_:1},8,["modelValue"]),d(D,{modelValue:n(a).description,"onUpdate:modelValue":o[1]||(o[1]=i=>n(a).description=i),placeholder:"Click to edit description"},{default:L(()=>[t("p",ke,w(n(a).description),1)]),_:1},8,["modelValue"]),t("div",be,[o[10]||(o[10]=t("h3",null,"Progress",-1)),t("div",_e,[t("div",$e,[t("progress",{value:n(e).progress(n(a)),max:"100"},null,8,we)]),t("span",Ce,w(n(e).progress(n(a)))+"%",1)])]),t("div",xe,[(f=n(a).remote)!=null&&f.length?(y(),N(h,{key:0,icon:"file_download",label:"Pull",onClick:o[2]||(o[2]=i=>n(e).pull({course:n(a)}))})):V("",!0),d(h,{icon:"file_upload",label:"Share",onClick:o[3]||(o[3]=i=>{var C;return(C=r.value)==null?void 0:C.open(n(a))})}),d(h,{icon:"school",label:"Start",type:"action-green",onClick:o[4]||(o[4]=i=>n(s).push(`/quiz/${n(a).id}`))}),d(h,{icon:"delete",label:"Delete",type:"action-red",onClick:o[5]||(o[5]=i=>n(e).removeCourse(n(a).id)&&n(s).push("/courses"))}),t("details",null,[o[11]||(o[11]=t("summary",null,"Advanced",-1)),t("div",Se,[d(h,{icon:"description",label:"Generate Summary",onClick:o[6]||(o[6]=i=>{var C;return(C=p.value)==null?void 0:C.open()})}),d(h,{icon:"code",label:"Edit in JSON",onClick:o[7]||(o[7]=i=>n(s).push(`${n(c).path}/json`))}),d(h,{icon:"replay",label:"Reset",onClick:o[8]||(o[8]=i=>n(e).resetProgress(n(a)))})])])])])):V("",!0),n(a)?(y(),_("div",Te,[(y(!0),_(M,null,F(n(a).questions,(i,C)=>(y(),_("div",Ve,[t("div",Me,[t("div",Ge,[d(h,{icon:"arrow_upward",onClick:S=>n(e).moveQuestionUp(n(a),i)},null,8,["onClick"]),t("span",Le,w(C+1)+" / "+w(n(a).questions.length),1),d(h,{icon:"arrow_downward",onClick:S=>n(e).moveQuestionDown(n(a),i)},null,8,["onClick"])]),t("div",Ue,[d(A,{options:n(Y),modelValue:i.type,"onUpdate:modelValue":S=>i.type=S,onChange:S=>T(i,S),label:"type"},null,8,["options","modelValue","onUpdate:modelValue","onChange"]),d(h,{icon:"delete",type:"action-red",onClick:S=>n(a).questions.splice(n(a).questions.indexOf(i),1)},null,8,["onClick"])]),t("div",Oe,[t("span",{class:"muted material-symbols-rounded cursor-pointer",onClick:S=>x(i.id)},w($.value.includes(i.id)?"expand_less":"expand_more"),9,Pe)])]),$.value.includes(i.id)?V("",!0):(y(),_("div",je,[d(I,{question:i,editable:""},null,8,["question"])]))]))),256)),t("div",De,[d(h,{icon:"add",label:"Add",type:"action-green",onClick:o[9]||(o[9]=i=>n(a).questions.push({id:Math.random().toString(36).substring(2,9),type:"text-answer",title:"",question:"",solution:""}))})])])):V("",!0)])])]}),_:1}))}}),Qe=O(ze,[["__scopeId","data-v-dfd58ddc"]]);export{Qe as default};
