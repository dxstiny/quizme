import{b as j,E as D,_ as B}from"./index.vue_vue_type_script_setup_true_lang-DcgEHl5l.js";import{d as L,r as k,e as A,o as F,s as G,f as I,a as g,c as _,b as t,F as M,t as w,m as d,I as h,k as V,v as J,x as Q,_ as O,D as E,y as N,g as z,i as U,n as X,h as R,j as n,l as W}from"./index-jyZd5ga3.js";import{_ as Y}from"./WithSidebar.vue_vue_type_style_index_0_lang-Dl5YWAVb.js";import"./FillInTheBlank.vue_vue_type_style_index_0_lang-BrvP5-SY.js";import"./ExpandedDropdown-CgYSQY_G.js";/* empty css                                                                         */import"./_commonjsHelpers-C4iS2aBk.js";const K=[{label:"Multiple Choice",value:"multiple-choice"},{label:"Multiple Answer",value:"multiple-answer"},{label:"Text Answer",value:"text-answer"},{label:"Number Answer",value:"number-answer"},{label:"True/False",value:"true-false"},{label:"Fill in the Blank",value:"fill-in-the-blank"},{label:"Matching",value:"matching"},{label:"Ordering",value:"ordering"},{label:"Flashcard",value:"flashcard"}],Z={class:"options"},q={key:0,class:"option"},ee={class:"option"},te={class:"option"},le={key:0},se=["value"],oe={key:1},ne={class:"options"},ae=L({__name:"ShareModal",setup(v,{expose:p}){const l=k(!1),e=k(""),u=k(!1),c=k(!1),m=k(),a=k(null),T=A(),$=k(""),x=k();F(()=>{const y=G.pat();l.value=!!y});const r=y=>{var o,b;a.value=null,(o=x.value)==null||o.showModal(),y.id!==((b=m.value)==null?void 0:b.id)&&(u.value=!1,c.value=!1,e.value=""),m.value=y},s=()=>{G.setPat($.value),l.value=!0},f=async()=>{const y=m.value;if(!y)return;const o=JSON.parse(JSON.stringify(y));delete o.remote,u.value||(o.score={}),e.value=await T.shareCourse(o,c.value)??""},i=()=>{var y;T.downloadCourse(m.value),(y=x.value)==null||y.close()},C=()=>{var b;const y=m.value;if(!y)return;const o=JSON.parse(JSON.stringify(y));u.value||(o.score={}),T.shareCourse(o,c.value),(b=x.value)==null||b.close()},S=I(()=>{var o,b;if(!((b=(o=m.value)==null?void 0:o.remote)!=null&&b.length))return!1;const y=m.value.remote[0].identifier;return G.isMine(y)});return p({open:r}),(y,o)=>(g(),_("dialog",{ref_key:"dialog",ref:x},[t("span",{class:"material-symbols-rounded close",onClick:o[0]||(o[0]=b=>{var P;return(P=x.value)==null?void 0:P.close()})}," close "),!a.value&&m.value?(g(),_(M,{key:0},[t("h1",null,'Share "'+w(m.value.title)+'"',1),t("div",Z,[S.value?(g(),_("div",q,[o[5]||(o[5]=t("div",{class:"info"},[t("h3",null,"Update remote"),t("p",null," This course is already shared. Update the remote to share the latest changes. ")],-1)),d(h,{type:"action-green",icon:"update",label:"Update",onClick:C})])):V("",!0),t("div",ee,[o[6]||(o[6]=t("div",{class:"info"},[t("h3",null,"New share"),t("p",null," Share this course for the first time. This will create a new gist on GitHub. ")],-1)),d(h,{type:"action-green",icon:"share",label:"Share",onClick:o[1]||(o[1]=b=>a.value="gist")})]),t("div",te,[o[7]||(o[7]=t("div",{class:"info"},[t("h3",null,"Download"),t("p",null," Download the course as a JSON file. This can be used to import the course on another device. ")],-1)),d(h,{type:"action-green",icon:"download",label:"Download",onClick:i})])])],64)):!l.value&&a.value?(g(),_(M,{key:1},[o[8]||(o[8]=t("h1",null,"GitHub Gists PAT",-1)),o[9]||(o[9]=t("p",null," To use this feature, you need to provide a GitHub Gists PAT. This is used to create gists for sharing courses. ",-1)),J(t("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=b=>$.value=b),placeholder:"Enter your PAT here"},null,512),[[Q,$.value]]),d(h,{type:"action-green",icon:"done",label:"Save",disabled:!$.value.length,onClick:s},null,8,["disabled"])],64)):a.value=="gist"&&m.value?(g(),_(M,{key:2},[t("h1",null,'Share "'+w(m.value.title)+'"',1),e.value?(g(),_("div",le,[o[10]||(o[10]=t("p",null,"Your share link:",-1)),t("input",{type:"text",readonly:"",value:e.value},null,8,se)])):(g(),_("div",oe,[o[11]||(o[11]=t("p",null," To share this course, click the button below. This will create a gist on GitHub with the course data. ",-1)),t("div",ne,[d(j,{label:"Include Progress",modelValue:u.value,"onUpdate:modelValue":o[3]||(o[3]=b=>u.value=b)},null,8,["modelValue"]),d(j,{label:"Public Gist",modelValue:c.value,"onUpdate:modelValue":o[4]||(o[4]=b=>c.value=b)},null,8,["modelValue"])]),d(h,{type:"action-green",icon:"share",label:"Share",onClick:f})]))],64)):V("",!0)],512))}}),ie=O(ae,[["__scopeId","data-v-856da437"]]),re=v=>{let p=`# ${v.title}
`;return p+=H(v,{insertHeading:l=>`## ${l}
`,insertDescription:l=>`${l}
`,insertList:l=>l.map(e=>`- ${e}`).join(`
`)+`
`,insertMap:l=>Object.entries(l).map(([e,u])=>`- ${e} -> ${u}`).join(`
`)+`
`,insertText:l=>`${l}
`}),p},ue=v=>{let p=`\\documentclass{article}

\\usepackage{csquotes}
\\usepackage[T1]{fontenc}

\\raggedright

\\title{${v.title}}
\\author{Generated by QuizMe}
\\date{\\today}

\\begin{document}

\\maketitle
`;const l=e=>e.replace(/\\/g,"\\textbackslash{}").replace(/\{/g,"\\{").replace(/\}/g,"\\}").replace(/&/g,"\\&").replace(/%/g,"\\%").replace(/\$/g,"\\$").replace(/#/g,"\\#").replace(/"([^"]*)"/g,"\\enquote{$1}");return p+=H(v,{insertHeading:e=>`\\section{${l(e)}}
`,insertDescription:e=>`${l(e)}
`,insertList:e=>`\\begin{itemize}
${e.map(u=>`\\item ${l(u)}`).join(`
`)}
\\end{itemize}
`,insertMap:e=>`\\begin{itemize}
${Object.entries(e).map(([u,c])=>`\\item ${l(u)} \\textrightarrow ${l(c)}`).join(`
`)}
\\end{itemize}
`,insertText:e=>`${l(e)}
`}),p+=`
\\end{document}
`,de(p)},H=(v,p)=>{let l="";for(const e of v.questions)if(!(e.type==="true-false"&&!e.solution))switch(l+=p.insertHeading(e.title),l+=p.insertDescription(e.question),e.type){case"multiple-answer":l+=p.insertList(e.solution.map(u=>e.options[u]));break;case"multiple-choice":l+=p.insertText(e.options[e.solution]);break;case"ordering":l+=p.insertList(e.solution);break;case"true-false":break;case"fill-in-the-blank":l+=e.solution;break;case"matching":l+=p.insertMap(e.solution);break;default:l+=p.insertText(String(e.solution));break}return l},de=v=>{const p=v.split(`
`);let l=0;const e=[];for(const u of p){let c=u.trim();if((c.startsWith("\\item -")||c.startsWith("\\item *"))&&(l===0&&(e.push("\\begin{itemize}"),l++),c=c.replace(/\\item [-*]/,"-").trim(),console.log(c)),c.startsWith("-")||c.startsWith("*")){l===0&&(e.push("\\begin{itemize}"),l++);const m=c.replace(/^-/,"").trim();e.push(`  \\item ${m}`)}else{for(let m=0;m<l;m++)e.push("\\end{itemize}");l=0,e.push(u)}}for(let u=0;u<l;u++)e.push("\\end{itemize}");return e.join(`
`)},ce={class:"export-options"},pe=["href","download"],me={class:"output"},ve=L({__name:"SummaryGenerator",props:{course:{type:Object,required:!1}},setup(v,{expose:p}){const l=k("LaTeX"),e=k(null),u=k(!1),c=k(!1),m=k(),a=v,T=()=>{var s;e.value=null,u.value=!1,c.value=!1,(s=m.value)==null||s.showModal()},$=()=>{if(a.course)switch(l.value){case"LaTeX":e.value=ue(a.course);break;case"Markdown":e.value=re(a.course);break}},x=s=>s==="LaTeX"?"tex":"md",r=()=>{e.value&&(navigator.clipboard.writeText(e.value),u.value=!0)};return p({open:T}),(s,f)=>(g(),_("dialog",{ref_key:"dialog",ref:m},[t("span",{class:"material-symbols-rounded close",onClick:f[0]||(f[0]=i=>{var C;return(C=m.value)==null?void 0:C.close()})}," close "),v.course&&!e.value?(g(),_(M,{key:0},[t("h1",null,'Create a Summary for "'+w(v.course.title)+'"',1),f[3]||(f[3]=t("p",null,"Choose the format for the summary you want to generate.",-1)),d(E,{modelValue:l.value,"onUpdate:modelValue":f[1]||(f[1]=i=>l.value=i),options:[{label:"LaTeX",value:"LaTeX"},{label:"Markdown",value:"Markdown"}]},null,8,["modelValue"]),d(h,{icon:"play_arrow",label:"Generate",onClick:$,type:"action-green"})],64)):v.course&&e.value?(g(),_(M,{key:1},[t("h1",null,'Summary for "'+w(v.course.title)+'"',1),t("div",ce,[t("a",{href:"data:text/plain;charset=utf-8,"+encodeURIComponent(e.value),download:"summary."+x(l.value),onClick:f[2]||(f[2]=i=>c.value=!0)},[t("span",{class:N(["material-symbols-rounded option",{clicked:c.value}])},w(c.value?"download_done":"file_download"),3)],8,pe),t("span",{class:N(["material-symbols-rounded option",{clicked:u.value}]),onClick:r},w(u.value?"assignment_turned_in":"content_copy"),3)]),t("div",me,[t("p",null,w(e.value),1)])],64)):V("",!0)],512))}}),fe=O(ve,[["__scopeId","data-v-f6182516"]]),he={class:"wrap"},ge={class:"editor"},ye={key:0,class:"meta"},be={class:"muted"},ke={class:"card"},_e={class:"progress"},$e={class:"bar"},we=["value"],Ce={class:"muted"},xe={class:"actions"},Se={class:"actions"},Te={key:1,class:"questions"},Ve={class:"question-wrapper"},Me={class:"header"},Ge={class:"left"},Ue={class:"muted"},Le={class:"middle"},Oe={class:"right"},Pe=["onClick"],je={key:0,class:"content"},De={class:"actions"},Ne=L({__name:"index",setup(v){const p=X(),l=R(),e=A(),u=k(),c=k(),m=p.params.id,a=e.courses.find(r=>r.id===m);a||l.push("/");const T=(r,s)=>{const f=r.type;if(f===s)return!1;let i=!1;return typeof r.solution=="array"?i=r.solution.length>0:typeof r.solution=="object"?i=Object.keys(r.solution).length>0:i=!!r.solution,i&&!confirm("Are you sure you want to change the question type?")?!1:(s==="multiple-choice"?f==="multiple-answer"?r.solution=r.solution[0]:(r.options=[],r.solution=-1):s==="multiple-answer"?f==="multiple-choice"?r.solution=[r.solution]:(r.options=[],r.solution=[]):s==="ordering"?r.solution=[]:s==="fill-in-the-blank"?r.solution=[]:s==="matching"?r.solution={}:r.solution="",r.type=s,!0)},$=k([]),x=r=>{$.value.includes(r)?$.value=$.value.filter(s=>s!==r):$.value.push(r)};return(r,s)=>(g(),z(Y,null,{default:U(()=>{var f;return[d(ie,{ref_key:"shareModal",ref:u},null,512),d(fe,{ref_key:"summaryGenerator",ref:c,course:n(a)},null,8,["course"]),t("div",he,[t("div",ge,[n(a)?(g(),_("div",ye,[d(D,{modelValue:n(a).title,"onUpdate:modelValue":s[0]||(s[0]=i=>n(a).title=i),placeholder:"Click to edit title",class:"h1"},{default:U(()=>[t("h1",null,w(n(a).title),1)]),_:1},8,["modelValue"]),d(D,{modelValue:n(a).description,"onUpdate:modelValue":s[1]||(s[1]=i=>n(a).description=i),placeholder:"Click to edit description"},{default:U(()=>[t("p",be,w(n(a).description),1)]),_:1},8,["modelValue"]),t("div",ke,[s[10]||(s[10]=t("h3",null,"Progress",-1)),t("div",_e,[t("div",$e,[t("progress",{value:n(e).progress(n(a)),max:"100"},null,8,we)]),t("span",Ce,w(n(e).progress(n(a)))+"%",1)])]),t("div",xe,[(f=n(a).remote)!=null&&f.length?(g(),z(h,{key:0,icon:"file_download",label:"Pull",onClick:s[2]||(s[2]=i=>n(e).pull({course:n(a)}))})):V("",!0),d(h,{icon:"file_upload",label:"Share",onClick:s[3]||(s[3]=i=>{var C;return(C=u.value)==null?void 0:C.open(n(a))})}),d(h,{icon:"school",label:"Start",type:"action-green",onClick:s[4]||(s[4]=i=>n(l).push(`/quiz/${n(a).id}`))}),d(h,{icon:"delete",label:"Delete",type:"action-red",onClick:s[5]||(s[5]=i=>n(e).removeCourse(n(a).id)&&n(l).push("/courses"))}),t("details",null,[s[11]||(s[11]=t("summary",null,"Advanced",-1)),t("div",Se,[d(h,{icon:"description",label:"Generate Summary",onClick:s[6]||(s[6]=i=>{var C;return(C=c.value)==null?void 0:C.open()})}),d(h,{icon:"code",label:"Edit in JSON",onClick:s[7]||(s[7]=i=>n(l).push(`${n(p).path}/json`))}),d(h,{icon:"replay",label:"Reset",onClick:s[8]||(s[8]=i=>n(e).resetProgress(n(a)))})])])])])):V("",!0),n(a)?(g(),_("div",Te,[(g(!0),_(M,null,W(n(a).questions,(i,C)=>(g(),_("div",Ve,[t("div",Me,[t("div",Ge,[d(h,{icon:"arrow_upward",onClick:S=>n(e).moveQuestionUp(n(a),i)},null,8,["onClick"]),t("span",Ue,w(C+1)+" / "+w(n(a).questions.length),1),d(h,{icon:"arrow_downward",onClick:S=>n(e).moveQuestionDown(n(a),i)},null,8,["onClick"])]),t("div",Le,[d(E,{options:n(K),modelValue:i.type,"onUpdate:modelValue":S=>i.type=S,onChange:S=>T(i,S),label:"type"},null,8,["options","modelValue","onUpdate:modelValue","onChange"]),d(h,{icon:"delete",type:"action-red",onClick:S=>n(a).questions.splice(n(a).questions.indexOf(i),1)},null,8,["onClick"])]),t("div",Oe,[t("span",{class:"muted material-symbols-rounded cursor-pointer",onClick:S=>x(i.id)},w($.value.includes(i.id)?"expand_less":"expand_more"),9,Pe)])]),$.value.includes(i.id)?V("",!0):(g(),_("div",je,[d(B,{question:i,editable:""},null,8,["question"])]))]))),256)),t("div",De,[d(h,{icon:"add",label:"Add",type:"action-green",onClick:s[9]||(s[9]=i=>n(a).questions.push({id:Math.random().toString(36).substring(2,9),type:"text-answer",title:"",question:"",solution:""}))})])])):V("",!0)])])]}),_:1}))}}),Je=O(Ne,[["__scopeId","data-v-cc93b51a"]]);export{Je as default};
