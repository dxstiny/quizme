import{_ as K,c as U,a as W}from"./index.vue_vue_type_script_setup_true_lang-DGa4SZSt.js";import{d as G,e as H,r as p,n as j,o as J,q as X,f as h,c as r,F as Y,b as t,t as f,j as E,g as R,k as _,I as m,l as Z,s as ee,a as i,p as te,m as se,_ as ne}from"./index-D-7qE5hs.js";import{u as oe}from"./stats-BId2XDDe.js";import"./FillInTheBlank.vue_vue_type_style_index_0_lang-uG_iiaDO.js";import"./_commonjsHelpers-C4iS2aBk.js";import"./ExpandedDropdown-CcY9vh6G.js";/* empty css                                                                         */const v=y=>(te("data-v-c5c79a72"),y=y(),se(),y),le={class:"quiz"},ue={class:"header"},ie={class:"justify-between"},ae={class:"flex gap-2"},re=["max","value"],ce={class:"body"},de={key:0,class:"correct-missed"},ve=v(()=>t("h1",null," Let's correct the exercises you got wrong last time! ",-1)),he=[ve],pe={key:1,class:"end"},fe=v(()=>t("h1",null,"Well done!",-1)),me={class:"review"},_e={class:"score"},ye=v(()=>t("span",{class:"label"},"SCORE",-1)),ge={class:"value"},ke={class:"time"},we=v(()=>t("span",{class:"label"},"TIME",-1)),be={class:"value"},qe={class:"footer"},xe={key:0,class:"check"},Ce={key:1,class:"check"},Te={key:2,class:"checking"},Se={key:0,class:"correct"},Ie=v(()=>t("div",{class:"continue"},[t("div",{class:"icon"},[t("span",{class:"material-symbols-rounded"},"check")])],-1)),Ae=v(()=>t("div",{class:"text"},[t("h2",null,"Correct!")],-1)),Me={class:"continue"},$e={key:1,class:"wrong"},je=v(()=>t("div",{class:"continue"},[t("div",{class:"icon"},[t("span",{class:"material-symbols-rounded"},"close")])],-1)),Ee={class:"text"},Re=v(()=>t("h2",null,"Correct solution:",-1)),Le={class:"continue"},Be=G({__name:"index",setup(y){const g=H(),k=oe(),x=p(j().params.id),T=e=>{if(!Array.from(document.body.querySelectorAll("dialog")).some(s=>s.hasAttribute("open"))&&e.key==="Enter"&&!e.shiftKey){if(e.target&&e.target.classList.contains("notes"))return;if(e.preventDefault(),e.stopImmediatePropagation(),q()){w.push("/");return}if(d.value){b();return}if(!S.value)return;A()}};J(()=>{const s=j().params.id;x.value=s,u.value=0,document.addEventListener("keydown",T)}),X(()=>{document.removeEventListener("keydown",T)});const c=p({correct:[],wrong:[],startTime:new Date,endTime:null}),l=p(g.getQuiz(x.value)),L=l.value.questions.length,w=ee(),u=p(0),n=h(()=>l.value.questions[u.value]),S=h(()=>{var s;const e=n.value;if(!e)return!1;if(e.type==="flashcard")return!0;if(e.type=="matching"){const o=e.answer||{},a=e.solution||{};return Object.keys(a).every($=>o[$]===a[$])}return e.type=="fill-in-the-blank"?!0:((s=l.value.questions[u.value])==null?void 0:s.answer)!=null}),B=h(()=>{var e;return((e=l.value.questions[u.value])==null?void 0:e.hint)!=null}),Q=()=>{alert(l.value.questions[u.value].hint)},d=p(!1),I=()=>{if(["flashcard","matching"].includes(n.value.type))return b(),!0;if(n.value.type=="multiple-answer"){const e=n.value.solution||[],s=n.value.answer||[];return e.every(o=>s.includes(o))}if(["ordering","fill-in-the-blank"].includes(n.value.type)){const e=n.value.solution||[],s=n.value.answer||[];return e.every((o,a)=>o===s[a])}return n.value.type==="text-answer"?U(n.value):n.value.type==="number-answer"?W(n.value):(console.log(n.value.answer),n.value.answer===D.value)},z=h(()=>{var e;return["matching","flashcard"].includes((e=n.value)==null?void 0:e.type)?"Continue":"Check"}),D=h(()=>n.value.solution),N=h(()=>{var s,o;const e=n.value;if(e.type==="multiple-choice")return e.options[e.solution];if(e.type==="multiple-answer")return e.solution.map(a=>e.options[a]).join(", ");if(e.type==="true-false")return e.solution?"True":"False";if(e.type==="text-answer")return e.solution?e.solution:e.solutionRegex?`Matches ${e.solutionRegex}`:(s=e.solutionAny)!=null&&s.length?`Matches any of ${e.solutionAny.join(", ")}`:(o=e.solutionAll)!=null&&o.length?`Matches all of ${e.solutionAll.join(", ")}`:"Any";if(e.type==="number-answer")return e.min!=null&&e.max!=null?"Between "+e.min+" and "+e.max:`${e.solution} (+/- ${e.delta})`;if(e.type==="ordering"||e.type==="fill-in-the-blank")return e.solution.join(", ")}),b=()=>{d.value=!1,u.value++,F()},q=()=>u.value===l.value.questions.length,F=()=>{q()&&(c.value.endTime=new Date,k.resetStreak(),k.addRun(c.value))},V=()=>{if(u.value===0){w.push("/");return}confirm("Are you sure you want to quit?")&&w.push("/")},A=()=>{d.value=!0;const e=n.value.id,s=g.getCourse(x.value),o=n.value;if(I()){c.value.correct.push(e),g.onCorrectQuestion(s,o),k.addToStreak();return}c.value.wrong.push(e),g.onIncorrectQuestion(s,o),k.resetStreak(),l.value.questions.filter(a=>a.id===e).length===1&&(l.value.questions.push({...o}),delete l.value.questions[l.value.questions.length-1].answer)},O=h(()=>{if(c.value.endTime==null)return 0;const e=c.value.endTime.getTime()-c.value.startTime.getTime(),s=Math.floor(e/1e3),o=Math.floor(s/60),a=(s-o*60).toString().padStart(2,"0");return`${o}:${a}`});let C=p(!1),M=null;const P=()=>M?!0:C.value?!1:u.value>=L?(M=window.setTimeout(()=>{C.value=!0},3e3),!0):!1;return(e,s)=>(i(),r("div",le,[q()?(i(),r("div",pe,[fe,t("div",me,[t("div",_e,[ye,t("span",ge,f(Math.round(c.value.correct.length/l.value.questions.length*100))+" % ",1)]),t("div",ke,[we,t("span",be,f(O.value),1)])])])):(i(),r(Y,{key:0},[t("div",ue,[t("div",ie,[t("h1",null,f(l.value.title),1),t("p",null,f(u.value+(d.value?1:0))+" / "+f(l.value.questions.length),1)]),t("div",ae,[t("span",{onClick:V,class:"material-symbols-rounded muted cursor-pointer"},"close"),t("progress",{max:l.value.questions.length,value:u.value+(d.value?1:0)},null,8,re)])]),t("div",ce,[P()&&!E(C)?(i(),r("div",de,he)):(i(),R(K,{key:1,question:l.value.questions[u.value],disabled:d.value,"show-correction":d.value},null,8,["question","disabled","show-correction"]))])],64)),t("div",qe,[q()?(i(),r("div",xe,[_(m,{class:"left",label:"Review Lesson",type:"minimal-grey"}),_(m,{class:"right",label:"Continue",type:"submit",onClick:s[0]||(s[0]=o=>E(w).push("/"))})])):d.value?(i(),r("div",Te,[I()?(i(),r("div",Se,[Ie,Ae,t("div",Me,[_(m,{label:"Continue",type:"submit",onClick:b})])])):(i(),r("div",$e,[je,t("div",Ee,[Re,t("p",null,f(N.value),1)]),t("div",Le,[_(m,{label:"Continue",type:"action-red",onClick:b})])]))])):(i(),r("div",Ce,[B.value?(i(),R(m,{key:0,class:"left",icon:"lightbulb",label:"Show Tip",type:"minimal-blue",onClick:Q})):Z("",!0),_(m,{class:"right",label:z.value,type:"submit",disabled:!S.value,onClick:A},null,8,["label","disabled"])]))])]))}}),Pe=ne(Be,[["__scopeId","data-v-c5c79a72"]]);export{Pe as default};
