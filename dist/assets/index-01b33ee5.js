import{_ as P}from"./Question.vue_vue_type_script_setup_true_lang-1d4f5393.js";import{d as W,a as G,j as m,k as L,l as H,m as J,c as p,f as r,F as K,e as t,t as w,g as R,b as B,n as g,I as y,h as U,o as a,p as X,i as Y,_ as Z}from"./index-e66d6f44.js";import{u as ee}from"./stats-4243ed18.js";const te=c=>{let i=c.answer,d=c.solution;return i?(c.ignoreCase&&(i=i.toLowerCase(),d=d.toLowerCase()),i===d):!1},_=c=>(X("data-v-db67615b"),c=c(),Y(),c),se={class:"quiz"},ne={class:"header"},oe={class:"flex gap-2"},le=["max","value"],ue={class:"body"},ae={key:0,class:"correct-missed"},ie=_(()=>t("h1",null," Let's correct the exercises you got wrong last time! ",-1)),re=[ie],ce={key:1,class:"end"},de=_(()=>t("h1",null,"Well done!",-1)),ve={class:"review"},he={class:"score"},_e=_(()=>t("span",null,"SCORE",-1)),pe={class:"value"},fe={class:"time"},me=_(()=>t("span",null,"TIME",-1)),ye={class:"value"},ge={class:"footer"},ke={key:0,class:"check"},we={key:1,class:"check"},be={key:2,class:"checking"},Ce={key:0,class:"correct"},qe=_(()=>t("div",{class:"continue"},[t("div",{class:"icon"},[t("span",{class:"material-symbols-rounded"},"check")])],-1)),xe=_(()=>t("div",{class:"text"},[t("h2",null,"Correct!")],-1)),Te={class:"continue"},Se={key:1,class:"wrong"},Ie=_(()=>t("div",{class:"continue"},[t("div",{class:"icon"},[t("span",{class:"material-symbols-rounded"},"close")])],-1)),Ee={class:"text"},Me=_(()=>t("h2",null,"Correct solution:",-1)),Le={class:"continue"},Re=W({__name:"index",setup(c){const i=G(),d=ee(),b=m(L().params.id);H(()=>{const s=L().params.id;b.value=s,u.value=0});const v=m({correct:[],wrong:[],startTime:new Date,endTime:null}),o=m(i.getQuiz(b.value)),Q=o.value.questions.length,C=J(),u=m(0),n=p(()=>o.value.questions[u.value]),T=p(()=>{var s;const e=n.value;if(!e)return!1;if(e.type==="flashcard")return!0;if(e.type=="matching"){const l=e.answer||{},h=e.solution||{};return Object.keys(h).every(M=>l[M]===h[M])}return((s=o.value.questions[u.value])==null?void 0:s.answer)!=null}),j=p(()=>{var e;return((e=o.value.questions[u.value])==null?void 0:e.hint)!=null}),z=()=>{alert(o.value.questions[u.value].hint)},f=m(!1),S=()=>{if(["flashcard","matching"].includes(n.value.type))return k(),!0;if(n.value.type=="multiple-answer"){const e=n.value.solution||[],s=n.value.answer||[];return e.every(l=>s.includes(l))}if(n.value.type=="ordering"){const e=n.value.solution||[],s=n.value.answer||[];return e.every((l,h)=>l===s[h])}return n.value.type==="text-answer"?te(n.value):n.value.answer===D.value},$=p(()=>{var e;return["matching","flashcard"].includes((e=n.value)==null?void 0:e.type)?"Continue":"Check"}),D=p(()=>n.value.solution),F=p(()=>{const e=n.value;if(e.type==="multiple-choice")return e.options[e.solution];if(e.type==="multiple-answer")return e.solution.map(s=>e.options[s]).join(", ");if(e.type==="true-false")return e.solution?"True":"False";if(["text-answer","number-answer"].includes(e.type))return e.solution;if(e.type==="ordering")return e.solution.join(", ")}),k=()=>{console.log("next"),f.value=!1,u.value++,N()},q=()=>u.value===o.value.questions.length,N=()=>{q()&&(v.value.endTime=new Date,d.resetStreak(),d.addRun(v.value))},V=()=>{if(u.value===0){console.log("quit"),C.push("/");return}confirm("Are you sure you want to quit?")&&C.push("/")},I=()=>{console.log("check"),f.value=!0;const e=n.value.id,s=i.getCourse(b.value),l=n.value;if(S()){v.value.correct.push(e),i.onCorrectQuestion(s,l),d.addToStreak();return}v.value.wrong.push(e),i.onIncorrectQuestion(s,l),d.resetStreak(),o.value.questions.filter(h=>h.id===e).length===1&&(o.value.questions.push(l),delete o.value.questions[o.value.questions.length-1].answer)},A=p(()=>{if(v.value.endTime==null)return 0;const e=v.value.endTime.getTime()-v.value.startTime.getTime(),s=Math.floor(e/1e3),l=Math.floor(s/60),h=(s-l*60).toString().padStart(2,"0");return`${l}:${h}`});document.addEventListener("keydown",e=>{if(e.key==="Enter"){if(f.value){k();return}if(!T.value)return;I()}});let x=m(!1),E=null;const O=()=>E?!0:x.value?!1:u.value>=Q?(E=window.setTimeout(()=>{x.value=!0},3e3),!0):!1;return(e,s)=>(a(),r("div",se,[q()?(a(),r("div",ce,[de,t("div",ve,[t("div",he,[_e,t("span",pe,w(Math.round(v.value.correct.length/o.value.questions.length*100))+" % ",1)]),t("div",fe,[me,t("span",ye,w(A.value),1)])])])):(a(),r(K,{key:0},[t("div",ne,[t("h1",null,w(o.value.title),1),t("div",oe,[t("span",{onClick:V,class:"material-symbols-rounded muted cursor-pointer"},"close"),t("progress",{max:o.value.questions.length,value:u.value+(f.value?1:0)},null,8,le)])]),t("div",ue,[O()&&!R(x)?(a(),r("div",ae,re)):(a(),B(P,{key:1,question:o.value.questions[u.value],disabled:f.value},null,8,["question","disabled"]))])],64)),t("div",ge,[q()?(a(),r("div",ke,[g(y,{class:"left",label:"Review Lesson",type:"minimal-grey"}),g(y,{class:"right",label:"Continue",type:"submit",onClick:s[0]||(s[0]=l=>R(C).push("/"))})])):f.value?(a(),r("div",be,[S()?(a(),r("div",Ce,[qe,xe,t("div",Te,[g(y,{label:"Continue",type:"submit",onClick:k})])])):(a(),r("div",Se,[Ie,t("div",Ee,[Me,t("p",null,w(F.value),1)]),t("div",Le,[g(y,{label:"Continue",type:"action-red",onClick:k})])]))])):(a(),r("div",we,[j.value?(a(),B(y,{key:0,class:"left",icon:"lightbulb",label:"Show Tip",type:"minimal-blue",onClick:z})):U("",!0),g(y,{class:"right",label:$.value,type:"submit",disabled:!T.value,onClick:I},null,8,["label","disabled"])]))])]))}});const ze=Z(Re,[["__scopeId","data-v-db67615b"]]);export{ze as default};
