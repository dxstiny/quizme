import{_ as P,c as W,a as G}from"./index.vue_vue_type_script_setup_true_lang-2f741705.js";import{d as H,a as J,j as _,k as R,l as K,m as U,c as v,f as r,F as X,e as t,t as w,g as A,b as E,n as f,I as p,h as Y,o as a,p as Z,i as ee,_ as te}from"./index-c111d770.js";import{u as se}from"./stats-449c955d.js";import"./ExpandedDropdown-885b4c20.js";const d=m=>(Z("data-v-538f298a"),m=m(),ee(),m),ne={class:"quiz"},oe={class:"header"},ue={class:"flex gap-2"},le=["max","value"],ae={class:"body"},ie={key:0,class:"correct-missed"},re=d(()=>t("h1",null," Let's correct the exercises you got wrong last time! ",-1)),ce=[re],de={key:1,class:"end"},ve=d(()=>t("h1",null,"Well done!",-1)),he={class:"review"},_e={class:"score"},pe=d(()=>t("span",null,"SCORE",-1)),fe={class:"value"},me={class:"time"},ye=d(()=>t("span",null,"TIME",-1)),ge={class:"value"},ke={class:"footer"},we={key:0,class:"check"},be={key:1,class:"check"},qe={key:2,class:"checking"},xe={key:0,class:"correct"},Ce=d(()=>t("div",{class:"continue"},[t("div",{class:"icon"},[t("span",{class:"material-symbols-rounded"},"check")])],-1)),Te=d(()=>t("div",{class:"text"},[t("h2",null,"Correct!")],-1)),Se={class:"continue"},Ie={key:1,class:"wrong"},Me=d(()=>t("div",{class:"continue"},[t("div",{class:"icon"},[t("span",{class:"material-symbols-rounded"},"close")])],-1)),$e={class:"text"},Re=d(()=>t("h2",null,"Correct solution:",-1)),Ae={class:"continue"},Ee=H({__name:"index",setup(m){const y=J(),g=se(),b=_(R().params.id);K(()=>{const s=R().params.id;b.value=s,l.value=0});const c=_({correct:[],wrong:[],startTime:new Date,endTime:null}),u=_(y.getQuiz(b.value)),j=u.value.questions.length,q=U(),l=_(0),n=v(()=>u.value.questions[l.value]),T=v(()=>{var s;const e=n.value;if(!e)return!1;if(e.type==="flashcard")return!0;if(e.type=="matching"){const o=e.answer||{},i=e.solution||{};return Object.keys(i).every($=>o[$]===i[$])}return((s=u.value.questions[l.value])==null?void 0:s.answer)!=null}),B=v(()=>{var e;return((e=u.value.questions[l.value])==null?void 0:e.hint)!=null}),Q=()=>{alert(u.value.questions[l.value].hint)},h=_(!1),S=()=>{if(["flashcard","matching"].includes(n.value.type))return k(),!0;if(n.value.type=="multiple-answer"){const e=n.value.solution||[],s=n.value.answer||[];return e.every(o=>s.includes(o))}if(n.value.type=="ordering"){const e=n.value.solution||[],s=n.value.answer||[];return e.every((o,i)=>o===s[i])}return n.value.type==="text-answer"?W(n.value):n.value.type==="number-answer"?G(n.value):n.value.answer===L.value},z=v(()=>{var e;return["matching","flashcard"].includes((e=n.value)==null?void 0:e.type)?"Continue":"Check"}),L=v(()=>n.value.solution),N=v(()=>{var s,o;const e=n.value;if(e.type==="multiple-choice")return e.options[e.solution];if(e.type==="multiple-answer")return e.solution.map(i=>e.options[i]).join(", ");if(e.type==="true-false")return e.solution?"True":"False";if(e.type==="text-answer")return e.solution?e.solution:e.solutionRegex?`Matches ${e.solutionRegex}`:(s=e.solutionAny)!=null&&s.length?`Matches any of ${e.solutionAny.join(", ")}`:(o=e.solutionAll)!=null&&o.length?`Matches all of ${e.solutionAll.join(", ")}`:"Any";if(e.type==="number-answer")return e.min!=null&&e.max!=null?"Between "+e.min+" and "+e.max:`${e.solution} (+/- ${e.delta})`;if(e.type==="ordering")return e.solution.join(", ")}),k=()=>{h.value=!1,l.value++,D()},x=()=>l.value===u.value.questions.length,D=()=>{x()&&(c.value.endTime=new Date,g.resetStreak(),g.addRun(c.value))},F=()=>{if(l.value===0){q.push("/");return}confirm("Are you sure you want to quit?")&&q.push("/")},I=()=>{h.value=!0;const e=n.value.id,s=y.getCourse(b.value),o=n.value;if(S()){c.value.correct.push(e),y.onCorrectQuestion(s,o),g.addToStreak();return}c.value.wrong.push(e),y.onIncorrectQuestion(s,o),g.resetStreak(),u.value.questions.filter(i=>i.id===e).length===1&&(u.value.questions.push(o),delete u.value.questions[u.value.questions.length-1].answer)},V=v(()=>{if(c.value.endTime==null)return 0;const e=c.value.endTime.getTime()-c.value.startTime.getTime(),s=Math.floor(e/1e3),o=Math.floor(s/60),i=(s-o*60).toString().padStart(2,"0");return`${o}:${i}`});document.addEventListener("keydown",e=>{if(e.key==="Enter"){if(h.value){k();return}if(!T.value)return;I()}});let C=_(!1),M=null;const O=()=>M?!0:C.value?!1:l.value>=j?(M=window.setTimeout(()=>{C.value=!0},3e3),!0):!1;return(e,s)=>(a(),r("div",ne,[x()?(a(),r("div",de,[ve,t("div",he,[t("div",_e,[pe,t("span",fe,w(Math.round(c.value.correct.length/u.value.questions.length*100))+" % ",1)]),t("div",me,[ye,t("span",ge,w(V.value),1)])])])):(a(),r(X,{key:0},[t("div",oe,[t("h1",null,w(u.value.title),1),t("div",ue,[t("span",{onClick:F,class:"material-symbols-rounded muted cursor-pointer"},"close"),t("progress",{max:u.value.questions.length,value:l.value+(h.value?1:0)},null,8,le)])]),t("div",ae,[O()&&!A(C)?(a(),r("div",ie,ce)):(a(),E(P,{key:1,question:u.value.questions[l.value],disabled:h.value},null,8,["question","disabled"]))])],64)),t("div",ke,[x()?(a(),r("div",we,[f(p,{class:"left",label:"Review Lesson",type:"minimal-grey"}),f(p,{class:"right",label:"Continue",type:"submit",onClick:s[0]||(s[0]=o=>A(q).push("/"))})])):h.value?(a(),r("div",qe,[S()?(a(),r("div",xe,[Ce,Te,t("div",Se,[f(p,{label:"Continue",type:"submit",onClick:k})])])):(a(),r("div",Ie,[Me,t("div",$e,[Re,t("p",null,w(N.value),1)]),t("div",Ae,[f(p,{label:"Continue",type:"action-red",onClick:k})])]))])):(a(),r("div",be,[B.value?(a(),E(p,{key:0,class:"left",icon:"lightbulb",label:"Show Tip",type:"minimal-blue",onClick:Q})):Y("",!0),f(p,{class:"right",label:z.value,type:"submit",disabled:!T.value,onClick:I},null,8,["label","disabled"])]))])]))}});const Le=te(Ee,[["__scopeId","data-v-538f298a"]]);export{Le as default};
