import{_ as O,c as P,a as K}from"./index.vue_vue_type_script_setup_true_lang-DcgEHl5l.js";import{d as U,e as W,r as f,n as $,o as G,p as H,f as v,c as a,F as J,b as s,t as m,j,g as E,m as h,I as p,k as X,h as Y,a as i,_ as Z}from"./index-jyZd5ga3.js";import{u as ee}from"./stats-CJnpnVlw.js";import"./FillInTheBlank.vue_vue_type_style_index_0_lang-BrvP5-SY.js";import"./_commonjsHelpers-C4iS2aBk.js";import"./ExpandedDropdown-CgYSQY_G.js";/* empty css                                                                         */const te={class:"quiz"},se={class:"header"},ne={class:"justify-between"},oe={class:"flex gap-2"},le=["max","value"],ue={class:"body"},ie={key:0,class:"correct-missed"},re={key:1,class:"end"},ae={class:"review"},ce={class:"score"},de={class:"value"},ve={class:"time"},fe={class:"value"},me={class:"footer"},pe={key:0,class:"check"},he={key:1,class:"check"},ye={key:2,class:"checking"},ge={key:0,class:"correct"},ke={class:"continue"},_e={key:1,class:"wrong"},we={class:"text"},be={class:"continue"},qe=U({__name:"index",setup(xe){const y=W(),g=ee(),b=f($().params.id),x=e=>{if(!Array.from(document.body.querySelectorAll("dialog")).some(t=>t.hasAttribute("open"))&&e.key==="Enter"&&!e.shiftKey){if(e.target&&e.target.classList.contains("notes"))return;if(e.preventDefault(),e.stopImmediatePropagation(),w()){k.push("/");return}if(d.value){_();return}if(!C.value)return;S()}};G(()=>{const t=$().params.id;b.value=t,u.value=0,document.addEventListener("keydown",x)}),H(()=>{document.removeEventListener("keydown",x)});const c=f({correct:[],wrong:[],startTime:new Date,endTime:null}),l=f(y.getQuiz(b.value)),I=l.value.questions.length,k=Y(),u=f(0),n=v(()=>l.value.questions[u.value]),C=v(()=>{var t;const e=n.value;if(!e)return!1;if(e.type==="flashcard")return!0;if(e.type=="matching"){const o=e.answer||{},r=e.solution||{};return Object.keys(r).every(M=>o[M]===r[M])}return e.type=="fill-in-the-blank"?!0:((t=l.value.questions[u.value])==null?void 0:t.answer)!=null}),R=v(()=>{var e;return((e=l.value.questions[u.value])==null?void 0:e.hint)!=null}),L=()=>{alert(l.value.questions[u.value].hint)},d=f(!1),T=()=>{if(["flashcard","matching"].includes(n.value.type))return _(),!0;if(n.value.type=="multiple-answer"){const e=n.value.solution||[],t=n.value.answer||[];return e.every(o=>t.includes(o))}if(["ordering","fill-in-the-blank"].includes(n.value.type)){const e=n.value.solution||[],t=n.value.answer||[];return e.every((o,r)=>o===t[r])}return n.value.type==="text-answer"?P(n.value):n.value.type==="number-answer"?K(n.value):(console.log(n.value.answer),n.value.answer===Q.value)},B=v(()=>{var e;return["matching","flashcard"].includes((e=n.value)==null?void 0:e.type)?"Continue":"Check"}),Q=v(()=>n.value.solution),z=v(()=>{var t,o;const e=n.value;if(e.type==="multiple-choice")return e.options[e.solution];if(e.type==="multiple-answer")return e.solution.map(r=>e.options[r]).join(", ");if(e.type==="true-false")return e.solution?"True":"False";if(e.type==="text-answer")return e.solution?e.solution:e.solutionRegex?`Matches ${e.solutionRegex}`:(t=e.solutionAny)!=null&&t.length?`Matches any of ${e.solutionAny.join(", ")}`:(o=e.solutionAll)!=null&&o.length?`Matches all of ${e.solutionAll.join(", ")}`:"Any";if(e.type==="number-answer")return e.min!=null&&e.max!=null?"Between "+e.min+" and "+e.max:`${e.solution} (+/- ${e.delta})`;if(e.type==="ordering"||e.type==="fill-in-the-blank")return e.solution.join(", ")}),_=()=>{d.value=!1,u.value++,D()},w=()=>u.value===l.value.questions.length,D=()=>{w()&&(c.value.endTime=new Date,g.resetStreak(),g.addRun(c.value))},N=()=>{if(u.value===0){k.push("/");return}confirm("Are you sure you want to quit?")&&k.push("/")},S=()=>{d.value=!0;const e=n.value.id,t=y.getCourse(b.value),o=n.value;if(T()){c.value.correct.push(e),y.onCorrectQuestion(t,o),g.addToStreak();return}c.value.wrong.push(e),y.onIncorrectQuestion(t,o),g.resetStreak(),l.value.questions.filter(r=>r.id===e).length===1&&(l.value.questions.push({...o}),delete l.value.questions[l.value.questions.length-1].answer)},F=v(()=>{if(c.value.endTime==null)return 0;const e=c.value.endTime.getTime()-c.value.startTime.getTime(),t=Math.floor(e/1e3),o=Math.floor(t/60),r=(t-o*60).toString().padStart(2,"0");return`${o}:${r}`});let q=f(!1),A=null;const V=()=>A?!0:q.value?!1:u.value>=I?(A=window.setTimeout(()=>{q.value=!0},3e3),!0):!1;return(e,t)=>(i(),a("div",te,[w()?(i(),a("div",re,[t[4]||(t[4]=s("h1",null,"Well done!",-1)),s("div",ae,[s("div",ce,[t[2]||(t[2]=s("span",{class:"label"},"SCORE",-1)),s("span",de,m(Math.round(c.value.correct.length/l.value.questions.length*100))+" % ",1)]),s("div",ve,[t[3]||(t[3]=s("span",{class:"label"},"TIME",-1)),s("span",fe,m(F.value),1)])])])):(i(),a(J,{key:0},[s("div",se,[s("div",ne,[s("h1",null,m(l.value.title),1),s("p",null,m(u.value+(d.value?1:0))+" / "+m(l.value.questions.length),1)]),s("div",oe,[s("span",{onClick:N,class:"material-symbols-rounded muted cursor-pointer"},"close"),s("progress",{max:l.value.questions.length,value:u.value+(d.value?1:0)},null,8,le)])]),s("div",ue,[V()&&!j(q)?(i(),a("div",ie,t[1]||(t[1]=[s("h1",null," Let's correct the exercises you got wrong last time! ",-1)]))):(i(),E(O,{key:1,question:l.value.questions[u.value],disabled:d.value,"show-correction":d.value},null,8,["question","disabled","show-correction"]))])],64)),s("div",me,[w()?(i(),a("div",pe,[h(p,{class:"left",label:"Review Lesson",type:"minimal-grey"}),h(p,{class:"right",label:"Continue",type:"submit",onClick:t[0]||(t[0]=o=>j(k).push("/"))})])):d.value?(i(),a("div",ye,[T()?(i(),a("div",ge,[t[5]||(t[5]=s("div",{class:"continue"},[s("div",{class:"icon"},[s("span",{class:"material-symbols-rounded"},"check")])],-1)),t[6]||(t[6]=s("div",{class:"text"},[s("h2",null,"Correct!")],-1)),s("div",ke,[h(p,{label:"Continue",type:"submit",onClick:_})])])):(i(),a("div",_e,[t[8]||(t[8]=s("div",{class:"continue"},[s("div",{class:"icon"},[s("span",{class:"material-symbols-rounded"},"close")])],-1)),s("div",we,[t[7]||(t[7]=s("h2",null,"Correct solution:",-1)),s("p",null,m(z.value),1)]),s("div",be,[h(p,{label:"Continue",type:"action-red",onClick:_})])]))])):(i(),a("div",he,[R.value?(i(),E(p,{key:0,class:"left",icon:"lightbulb",label:"Show Tip",type:"minimal-blue",onClick:L})):X("",!0),h(p,{class:"right",label:B.value,type:"submit",disabled:!C.value,onClick:S},null,8,["label","disabled"])]))])]))}}),Ee=Z(qe,[["__scopeId","data-v-c5c79a72"]]);export{Ee as default};
