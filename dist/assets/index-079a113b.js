import{_ as A}from"./Question.vue_vue_type_script_setup_true_lang-5c315de5.js";import{d as P,u as W,h as G,i as p,j as H,c,e as i,F as J,b as s,t as b,k as E,a as M,l as m,I as h,f as K,o as l,p as U,g as X,_ as Y}from"./index-fbf9f22c.js";import{u as Z}from"./stats-527eb255.js";const d=f=>(U("data-v-8daf8f99"),f=f(),X(),f),ee={class:"quiz"},se={class:"header"},te={class:"flex gap-2"},ne=["max","value"],oe={class:"body"},le={key:0,class:"correct-missed"},ue=d(()=>s("h1",null," Let's correct the exercises you got wrong last time! ",-1)),ae=[ue],ie={key:1,class:"end"},re=d(()=>s("h1",null,"Well done!",-1)),ce={class:"review"},de={class:"score"},ve=d(()=>s("span",null,"SCORE",-1)),_e={class:"value"},he={class:"time"},pe=d(()=>s("span",null,"TIME",-1)),me={class:"value"},fe={class:"footer"},ye={key:0,class:"check"},ke={key:1,class:"check"},ge={key:2,class:"checking"},we={key:0,class:"correct"},be=d(()=>s("div",{class:"continue"},[s("div",{class:"icon"},[s("span",{class:"material-symbols-rounded"},"check")])],-1)),qe=d(()=>s("div",{class:"text"},[s("h2",null,"Correct!")],-1)),Te={class:"continue"},xe={key:1,class:"wrong"},Ce=d(()=>s("div",{class:"continue"},[s("div",{class:"icon"},[s("span",{class:"material-symbols-rounded"},"close")])],-1)),Se={class:"text"},Ie=d(()=>s("h2",null,"Correct solution:",-1)),Ee={class:"continue"},Me=P({__name:"index",setup(f){const R=W(),B=G(),y=Z(),r=p({correct:[],wrong:[],startTime:new Date,endTime:null}),n=p(B.getQuiz(R.params.id)),j=n.value.questions.length,k=H(),u=p(0),o=c(()=>n.value.questions[u.value]),T=c(()=>{var t;const e=o.value;if(e.type=="matching"){const a=e.answer||{},_=e.solution||{};return Object.keys(_).every(I=>a[I]===_[I])}return((t=n.value.questions[u.value])==null?void 0:t.answer)!=null}),z=c(()=>{var e;return((e=n.value.questions[u.value])==null?void 0:e.hint)!=null}),L=()=>{alert(n.value.questions[u.value].hint)},v=p(!1),x=()=>{if(o.value.type==="matching")return g(),!0;if(o.value.type=="multiple-answer"){const e=o.value.solution||[],t=o.value.answer||[];return e.every(a=>t.includes(a))}if(o.value.type=="ordering"){const e=o.value.solution||[],t=o.value.answer||[];return e.every((a,_)=>a===t[_])}return o.value.answer===D.value},$=c(()=>o.value.type==="matching"?"Continue":"Check"),D=c(()=>o.value.solution),F=c(()=>{const e=o.value;if(e.type==="multiple-choice")return e.options[e.solution];if(e.type==="multiple-answer")return e.solution.map(t=>e.options[t]).join(", ");if(e.type==="true-false")return e.solution?"True":"False";if(["text-answer","number-answer"].includes(e.type))return e.solution;if(e.type==="ordering")return e.solution.join(", ")}),g=()=>{v.value=!1,u.value++,N()},w=c(()=>u.value===n.value.questions.length),N=()=>{w.value&&(r.value.endTime=new Date,y.resetStreak(),y.addRun(r.value))},Q=()=>{if(u.value===0){k.push("/");return}confirm("Are you sure you want to quit?")&&k.push("/")},C=()=>{v.value=!0;const e=o.value.id;if(x()){r.value.correct.push(e),y.addToStreak();return}r.value.wrong.push(e),y.resetStreak(),n.value.questions.filter(t=>t.id===e).length===1&&(n.value.questions.push(o.value),delete n.value.questions[n.value.questions.length-1].answer)},V=c(()=>{if(r.value.endTime==null)return 0;const e=r.value.endTime.getTime()-r.value.startTime.getTime(),t=Math.floor(e/1e3),a=Math.floor(t/60),_=(t-a*60).toString().padStart(2,"0");return`${a}:${_}`});document.addEventListener("keydown",e=>{if(e.key==="Enter"){if(w.value){k.push("/");return}if(v.value){g();return}if(!T.value)return;C()}});let q=p(!1),S=null;const O=()=>S?!0:q.value?!1:u.value>=j?(S=window.setTimeout(()=>{q.value=!0},3e3),!0):!1;return(e,t)=>(l(),i("div",ee,[w.value?(l(),i("div",ie,[re,s("div",ce,[s("div",de,[ve,s("span",_e,b(Math.round(r.value.correct.length/n.value.questions.length*100))+" % ",1)]),s("div",he,[pe,s("span",me,b(V.value),1)])])])):(l(),i(J,{key:0},[s("div",se,[s("h1",null,b(n.value.title),1),s("div",te,[s("span",{onClick:Q,class:"material-symbols-rounded muted cursor-pointer"},"close"),s("progress",{max:n.value.questions.length,value:u.value+(v.value?1:0)},null,8,ne)])]),s("div",oe,[O()&&!E(q)?(l(),i("div",le,ae)):(l(),M(A,{key:1,question:n.value.questions[u.value],disabled:v.value},null,8,["question","disabled"]))])],64)),s("div",fe,[w.value?(l(),i("div",ye,[m(h,{class:"left",label:"Review Lesson",type:"minimal-grey"}),m(h,{class:"right",label:"Continue",type:"submit",onClick:t[0]||(t[0]=a=>E(k).push("/"))})])):v.value?(l(),i("div",ge,[x()?(l(),i("div",we,[be,qe,s("div",Te,[m(h,{label:"Continue",type:"submit",onClick:g})])])):(l(),i("div",xe,[Ce,s("div",Se,[Ie,s("p",null,b(F.value),1)]),s("div",Ee,[m(h,{label:"Continue",type:"action-red",onClick:g})])]))])):(l(),i("div",ke,[z.value?(l(),M(h,{key:0,class:"left",icon:"lightbulb",label:"Show Tip",type:"minimal-blue",onClick:L})):K("",!0),m(h,{class:"right",label:$.value,type:"submit",disabled:!T.value,onClick:C},null,8,["label","disabled"])]))])]))}});const ze=Y(Me,[["__scopeId","data-v-8daf8f99"]]);export{ze as default};
