import{_ as A}from"./Question.vue_vue_type_script_setup_true_lang-e417a4cd.js";import{d as P,j as W,a as G,k as p,l as H,c as d,f as a,F as J,e as s,t as q,g as R,b as B,m,I as h,h as K,o as l,p as U,i as X,_ as Y}from"./index-43735dea.js";import{u as Z}from"./stats-fd8ab8fe.js";const r=f=>(U("data-v-e44ccc51"),f=f(),X(),f),ee={class:"quiz"},se={class:"header"},te={class:"flex gap-2"},ne=["max","value"],oe={class:"body"},ue={key:0,class:"correct-missed"},le=r(()=>s("h1",null," Let's correct the exercises you got wrong last time! ",-1)),ie=[le],ae={key:1,class:"end"},ce=r(()=>s("h1",null,"Well done!",-1)),re={class:"review"},de={class:"score"},ve=r(()=>s("span",null,"SCORE",-1)),_e={class:"value"},he={class:"time"},pe=r(()=>s("span",null,"TIME",-1)),me={class:"value"},fe={class:"footer"},ye={key:0,class:"check"},ke={key:1,class:"check"},ge={key:2,class:"checking"},we={key:0,class:"correct"},be=r(()=>s("div",{class:"continue"},[s("div",{class:"icon"},[s("span",{class:"material-symbols-rounded"},"check")])],-1)),qe=r(()=>s("div",{class:"text"},[s("h2",null,"Correct!")],-1)),Ce={class:"continue"},Te={key:1,class:"wrong"},xe=r(()=>s("div",{class:"continue"},[s("div",{class:"icon"},[s("span",{class:"material-symbols-rounded"},"close")])],-1)),Se={class:"text"},Ie=r(()=>s("h2",null,"Correct solution:",-1)),Ee={class:"continue"},Me=P({__name:"index",setup(f){const T=W(),y=G(),k=Z(),c=p({correct:[],wrong:[],startTime:new Date,endTime:null}),o=p(y.getQuiz(T.params.id)),Q=o.value.questions.length,g=H(),i=p(0),n=d(()=>o.value.questions[i.value]),x=d(()=>{var t;const e=n.value;if(e.type=="matching"){const u=e.answer||{},_=e.solution||{};return Object.keys(_).every(M=>u[M]===_[M])}return((t=o.value.questions[i.value])==null?void 0:t.answer)!=null}),j=d(()=>{var e;return((e=o.value.questions[i.value])==null?void 0:e.hint)!=null}),z=()=>{alert(o.value.questions[i.value].hint)},v=p(!1),S=()=>{if(n.value.type==="matching")return w(),!0;if(n.value.type=="multiple-answer"){const e=n.value.solution||[],t=n.value.answer||[];return e.every(u=>t.includes(u))}if(n.value.type=="ordering"){const e=n.value.solution||[],t=n.value.answer||[];return e.every((u,_)=>u===t[_])}return n.value.answer===$.value},L=d(()=>n.value.type==="matching"?"Continue":"Check"),$=d(()=>n.value.solution),D=d(()=>{const e=n.value;if(e.type==="multiple-choice")return e.options[e.solution];if(e.type==="multiple-answer")return e.solution.map(t=>e.options[t]).join(", ");if(e.type==="true-false")return e.solution?"True":"False";if(["text-answer","number-answer"].includes(e.type))return e.solution;if(e.type==="ordering")return e.solution.join(", ")}),w=()=>{v.value=!1,i.value++,F()},b=()=>i.value===o.value.questions.length,F=()=>{b()&&(c.value.endTime=new Date,k.resetStreak(),k.addRun(c.value))},N=()=>{if(i.value===0){g.push("/");return}confirm("Are you sure you want to quit?")&&g.push("/")},I=()=>{v.value=!0;const e=n.value.id,t=y.getCourse(T.params.id);if(S()){c.value.correct.push(e),y.onCorrectQuestion(t,n.value),k.addToStreak();return}c.value.wrong.push(e),y.onIncorrectQuestion(t,n.value),k.resetStreak(),o.value.questions.filter(u=>u.id===e).length===1&&(o.value.questions.push(n.value),delete o.value.questions[o.value.questions.length-1].answer)},V=d(()=>{if(c.value.endTime==null)return 0;const e=c.value.endTime.getTime()-c.value.startTime.getTime(),t=Math.floor(e/1e3),u=Math.floor(t/60),_=(t-u*60).toString().padStart(2,"0");return`${u}:${_}`});document.addEventListener("keydown",e=>{if(e.key==="Enter"){if(b()){g.push("/");return}if(v.value){w();return}if(!x.value)return;I()}});let C=p(!1),E=null;const O=()=>E?!0:C.value?!1:i.value>=Q?(E=window.setTimeout(()=>{C.value=!0},3e3),!0):!1;return(e,t)=>(l(),a("div",ee,[b()?(l(),a("div",ae,[ce,s("div",re,[s("div",de,[ve,s("span",_e,q(Math.round(c.value.correct.length/o.value.questions.length*100))+" % ",1)]),s("div",he,[pe,s("span",me,q(V.value),1)])])])):(l(),a(J,{key:0},[s("div",se,[s("h1",null,q(o.value.title),1),s("div",te,[s("span",{onClick:N,class:"material-symbols-rounded muted cursor-pointer"},"close"),s("progress",{max:o.value.questions.length,value:i.value+(v.value?1:0)},null,8,ne)])]),s("div",oe,[O()&&!R(C)?(l(),a("div",ue,ie)):(l(),B(A,{key:1,question:o.value.questions[i.value],disabled:v.value},null,8,["question","disabled"]))])],64)),s("div",fe,[b()?(l(),a("div",ye,[m(h,{class:"left",label:"Review Lesson",type:"minimal-grey"}),m(h,{class:"right",label:"Continue",type:"submit",onClick:t[0]||(t[0]=u=>R(g).push("/"))})])):v.value?(l(),a("div",ge,[S()?(l(),a("div",we,[be,qe,s("div",Ce,[m(h,{label:"Continue",type:"submit",onClick:w})])])):(l(),a("div",Te,[xe,s("div",Se,[Ie,s("p",null,q(D.value),1)]),s("div",Ee,[m(h,{label:"Continue",type:"action-red",onClick:w})])]))])):(l(),a("div",ke,[j.value?(l(),B(h,{key:0,class:"left",icon:"lightbulb",label:"Show Tip",type:"minimal-blue",onClick:z})):K("",!0),m(h,{class:"right",label:L.value,type:"submit",disabled:!x.value,onClick:I},null,8,["label","disabled"])]))])]))}});const je=Y(Me,[["__scopeId","data-v-e44ccc51"]]);export{je as default};
