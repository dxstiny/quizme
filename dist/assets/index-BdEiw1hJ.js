import{b as M,E as N,_ as J}from"./index.vue_vue_type_script_setup_true_lang-CZp9nGQa.js";import{d as D,r as f,e as A,o as F,s as T,f as j,a as c,c as v,b as e,F as V,t as b,m as i,I as d,k as S,v as H,x as I,_ as G,g as O,i as P,n as Q,h as R,j as o,l as Y,D as z}from"./index-fkUfuDGG.js";import{_ as L}from"./WithSidebar.vue_vue_type_style_index_0_lang-CPpWWZ8t.js";import"./FillInTheBlank.vue_vue_type_style_index_0_lang-CFw6Gsvs.js";import"./ExpandedDropdown-BxRWDugF.js";/* empty css                                                                         */import"./_commonjsHelpers-C4iS2aBk.js";const K=[{label:"Multiple Choice",value:"multiple-choice"},{label:"Multiple Answer",value:"multiple-answer"},{label:"Text Answer",value:"text-answer"},{label:"Number Answer",value:"number-answer"},{label:"True/False",value:"true-false"},{label:"Fill in the Blank",value:"fill-in-the-blank"},{label:"Matching",value:"matching"},{label:"Ordering",value:"ordering"},{label:"Flashcard",value:"flashcard"}],W={class:"options"},X={key:0,class:"option"},Z={class:"option"},q={class:"option"},ee={key:0},le=["value"],se={key:1},oe={class:"options"},te=D({__name:"ShareModal",setup(B,{expose:x}){const _=f(!1),p=f(""),g=f(!1),k=f(!1),s=f(),C=f(null),m=A(),w=f(""),t=f();F(()=>{const r=T.pat();_.value=!!r});const n=r=>{var l,u;C.value=null,(l=t.value)==null||l.showModal(),r.id!==((u=s.value)==null?void 0:u.id)&&(g.value=!1,k.value=!1,p.value=""),s.value=r},y=()=>{T.setPat(w.value),_.value=!0},a=async()=>{const r=s.value;if(!r)return;const l=JSON.parse(JSON.stringify(r));delete l.remote,g.value||(l.score={}),p.value=await m.shareCourse(l,k.value)??""},$=()=>{var r;m.downloadCourse(s.value),(r=t.value)==null||r.close()},h=()=>{var u;const r=s.value;if(!r)return;const l=JSON.parse(JSON.stringify(r));g.value||(l.score={}),m.shareCourse(l,k.value),(u=t.value)==null||u.close()},E=j(()=>{var l,u;if(!((u=(l=s.value)==null?void 0:l.remote)!=null&&u.length))return!1;const r=s.value.remote[0].identifier;return T.isMine(r)});return x({open:n}),(r,l)=>(c(),v("dialog",{ref_key:"dialog",ref:t},[e("span",{class:"material-symbols-rounded close",onClick:l[0]||(l[0]=u=>{var U;return(U=t.value)==null?void 0:U.close()})}," close "),!C.value&&s.value?(c(),v(V,{key:0},[e("h1",null,'Share "'+b(s.value.title)+'"',1),e("div",W,[E.value?(c(),v("div",X,[l[5]||(l[5]=e("div",{class:"info"},[e("h3",null,"Update remote"),e("p",null," This course is already shared. Update the remote to share the latest changes. ")],-1)),i(d,{type:"action-green",icon:"update",label:"Update",onClick:h})])):S("",!0),e("div",Z,[l[6]||(l[6]=e("div",{class:"info"},[e("h3",null,"New share"),e("p",null," Share this course for the first time. This will create a new gist on GitHub. ")],-1)),i(d,{type:"action-green",icon:"share",label:"Share",onClick:l[1]||(l[1]=u=>C.value="gist")})]),e("div",q,[l[7]||(l[7]=e("div",{class:"info"},[e("h3",null,"Download"),e("p",null," Download the course as a JSON file. This can be used to import the course on another device. ")],-1)),i(d,{type:"action-green",icon:"download",label:"Download",onClick:$})])])],64)):!_.value&&C.value?(c(),v(V,{key:1},[l[8]||(l[8]=e("h1",null,"GitHub Gists PAT",-1)),l[9]||(l[9]=e("p",null," To use this feature, you need to provide a GitHub Gists PAT. This is used to create gists for sharing courses. ",-1)),H(e("input",{type:"text","onUpdate:modelValue":l[2]||(l[2]=u=>w.value=u),placeholder:"Enter your PAT here"},null,512),[[I,w.value]]),i(d,{type:"action-green",icon:"done",label:"Save",disabled:!w.value.length,onClick:y},null,8,["disabled"])],64)):C.value=="gist"&&s.value?(c(),v(V,{key:2},[e("h1",null,'Share "'+b(s.value.title)+'"',1),p.value?(c(),v("div",ee,[l[10]||(l[10]=e("p",null,"Your share link:",-1)),e("input",{type:"text",readonly:"",value:p.value},null,8,le)])):(c(),v("div",se,[l[11]||(l[11]=e("p",null," To share this course, click the button below. This will create a gist on GitHub with the course data. ",-1)),e("div",oe,[i(M,{label:"Include Progress",modelValue:g.value,"onUpdate:modelValue":l[3]||(l[3]=u=>g.value=u)},null,8,["modelValue"]),i(M,{label:"Public Gist",modelValue:k.value,"onUpdate:modelValue":l[4]||(l[4]=u=>k.value=u)},null,8,["modelValue"])]),i(d,{type:"action-green",icon:"share",label:"Share",onClick:a})]))],64)):S("",!0)],512))}}),ne=G(te,[["__scopeId","data-v-856da437"]]),ae={class:"wrap"},ie={class:"editor"},re={key:0,class:"meta"},ue={class:"muted"},de={class:"card"},ce={class:"progress"},pe={class:"bar"},ve=["value"],me={class:"muted"},fe={class:"actions"},he={key:1,class:"questions"},_e={class:"question-wrapper"},ge={class:"header"},ye={class:"left"},be={class:"muted"},ke={class:"middle"},Ce={class:"right"},we=["onClick"],$e={key:0,class:"content"},Se={class:"actions"},xe=D({__name:"index",setup(B){const x=Q(),_=R(),p=A(),g=f(),k=x.params.id,s=p.courses.find(t=>t.id===k);s||_.push("/");const C=(t,n)=>{const y=t.type;if(y===n)return!1;let a=!1;return typeof t.solution=="array"?a=t.solution.length>0:typeof t.solution=="object"?a=Object.keys(t.solution).length>0:a=!!t.solution,a&&!confirm("Are you sure you want to change the question type?")?!1:(n==="multiple-choice"?y==="multiple-answer"?t.solution=t.solution[0]:(t.options=[],t.solution=-1):n==="multiple-answer"?y==="multiple-choice"?t.solution=[t.solution]:(t.options=[],t.solution=[]):n==="ordering"?t.solution=[]:n==="fill-in-the-blank"?t.solution=[]:n==="matching"?t.solution={}:t.solution="",t.type=n,!0)},m=f([]),w=t=>{m.value.includes(t)?m.value=m.value.filter(n=>n!==t):m.value.push(t)};return(t,n)=>(c(),O(L,null,{default:P(()=>{var y;return[i(ne,{ref_key:"shareModal",ref:g},null,512),e("div",ae,[e("div",ie,[o(s)?(c(),v("div",re,[i(N,{modelValue:o(s).title,"onUpdate:modelValue":n[0]||(n[0]=a=>o(s).title=a),class:"h1"},{default:P(()=>[e("h1",null,b(o(s).title),1)]),_:1},8,["modelValue"]),i(N,{modelValue:o(s).description,"onUpdate:modelValue":n[1]||(n[1]=a=>o(s).description=a)},{default:P(()=>[e("p",ue,b(o(s).description),1)]),_:1},8,["modelValue"]),e("div",de,[n[9]||(n[9]=e("h3",null,"Progress",-1)),i(d,{icon:"replay",label:"Reset",onClick:n[2]||(n[2]=a=>o(p).resetProgress(o(s)))}),e("div",ce,[e("div",pe,[e("progress",{value:o(p).progress(o(s)),max:"100"},null,8,ve)]),e("span",me,b(o(p).progress(o(s)))+"%",1)])]),e("div",fe,[(y=o(s).remote)!=null&&y.length?(c(),O(d,{key:0,icon:"file_download",label:"Pull",onClick:n[3]||(n[3]=a=>o(p).pull({course:o(s)}))})):S("",!0),i(d,{icon:"file_upload",label:"Share",onClick:n[4]||(n[4]=a=>{var $;return($=g.value)==null?void 0:$.open(o(s))})}),i(d,{icon:"code",label:"Edit in JSON",onClick:n[5]||(n[5]=a=>o(_).push(`${o(x).path}/json`))}),i(d,{icon:"school",label:"Start",type:"action-green",onClick:n[6]||(n[6]=a=>o(_).push(`/quiz/${o(s).id}`))}),i(d,{icon:"delete",label:"Delete",type:"action-red",onClick:n[7]||(n[7]=a=>o(p).removeCourse(o(s).id)&&o(_).push("/courses"))})])])):S("",!0),o(s)?(c(),v("div",he,[(c(!0),v(V,null,Y(o(s).questions,(a,$)=>(c(),v("div",_e,[e("div",ge,[e("div",ye,[i(d,{icon:"arrow_upward",onClick:h=>o(p).moveQuestionUp(o(s),a)},null,8,["onClick"]),e("span",be,b($+1)+" / "+b(o(s).questions.length),1),i(d,{icon:"arrow_downward",onClick:h=>o(p).moveQuestionDown(o(s),a)},null,8,["onClick"])]),e("div",ke,[i(z,{options:o(K),modelValue:a.type,"onUpdate:modelValue":h=>a.type=h,onChange:h=>C(a,h),label:"type"},null,8,["options","modelValue","onUpdate:modelValue","onChange"]),i(d,{icon:"delete",type:"action-red",onClick:h=>o(s).questions.splice(o(s).questions.indexOf(a),1)},null,8,["onClick"])]),e("div",Ce,[e("span",{class:"muted material-symbols-rounded cursor-pointer",onClick:h=>w(a.id)},b(m.value.includes(a.id)?"expand_less":"expand_more"),9,we)])]),m.value.includes(a.id)?S("",!0):(c(),v("div",$e,[i(J,{question:a,editable:""},null,8,["question"])]))]))),256)),e("div",Se,[i(d,{icon:"add",label:"Add",type:"action-green",onClick:n[8]||(n[8]=a=>o(s).questions.push({id:Math.random().toString(36).substring(2,9),type:"text-answer",title:"",question:"",solution:""}))})])])):S("",!0)])])]}),_:1}))}}),De=G(xe,[["__scopeId","data-v-17dad597"]]);export{De as default};
